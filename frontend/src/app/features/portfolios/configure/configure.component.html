<div class="configure-tab-content">
  @if (selectedPortfolio) {
    @if (isLoading) {
      <!-- Loading State -->
      <div class="loading-message">
        <i class="pi pi-spin pi-spinner"></i>
        <p>Loading configuration...</p>
      </div>
    } @else if (errorMessage) {
      <!-- Error State -->
      <div class="error-message">
        <i class="pi pi-exclamation-triangle"></i>
        <h3>Error Loading Configuration</h3>
        <p>{{ errorMessage }}</p>
        <button pButton 
                label="Retry" 
                icon="pi pi-refresh" 
                class="p-button-outlined"
                (click)="loadConfig(selectedPortfolio.id)">
        </button>
      </div>
    } @else if (portfolioConfig) {
      <!-- Configuration Form - Placeholder for Task 5 -->
      <div class="configure-form">
        <h3>Portfolio Configuration</h3>
        <p class="info-text">Configuration form will be implemented in Task 5</p>
        
        <!-- Minimal form for testing -->
        <div class="form-row">
          <div class="form-field">
            <label for="tradingMode">Trading Mode</label>
            <input pInputText 
                   id="tradingMode"
                   [(ngModel)]="portfolioConfig.tradingMode"
                   (ngModelChange)="onFormChange()"
                   placeholder="paper"
                   [disabled]="isSaving" />
          </div>
          <div class="form-field">
            <label for="signalCheckInterval">Signal Check Interval (seconds)</label>
            <input pInputText 
                   id="signalCheckInterval"
                   type="number"
                   [(ngModel)]="portfolioConfig.signalCheckInterval"
                   (ngModelChange)="onFormChange()"
                   placeholder="300"
                   [disabled]="isSaving" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-field">
            <label for="lookbackDays">Lookback Days</label>
            <input pInputText 
                   id="lookbackDays"
                   type="number"
                   [(ngModel)]="portfolioConfig.lookbackDays"
                   (ngModelChange)="onFormChange()"
                   placeholder="30"
                   [disabled]="isSaving" />
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="form-actions">
          <button pButton 
                  label="Reset" 
                  class="p-button-outlined"
                  (click)="cancelEdit()"
                  [disabled]="!isFormDirty || isSaving">
          </button>
          <button pButton 
                  label="Save Configuration" 
                  class="p-button-success"
                  (click)="saveConfiguration()"
                  [disabled]="!isFormDirty || isSaving">
            @if (isSaving) {
              <i class="pi pi-spin pi-spinner"></i>
            }
          </button>
        </div>

        <!-- Config Status Info -->
        <div class="config-info">
          <p><strong>Status:</strong> {{ configExists ? 'Existing Configuration' : 'New Configuration (will be created on save)' }}</p>
        </div>
      </div>
    }
  } @else {
    <div class="no-selection-message">
      <i class="pi pi-info-circle"></i>
      <h3>No Portfolio Selected</h3>
      <p>Please select a portfolio from the Overview tab to configure it.</p>
      <button pButton 
              label="Back to Overview" 
              icon="pi pi-arrow-left" 
              class="p-button-outlined"
              (click)="navigateToOverview()">
      </button>
    </div>
  }
</div>
