.content-section {
  // Portfolio Display Container
  .portfolio-display-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    height: 100%;
  }

  // Controls Section Styling
  .controls-section {
    background: var(--surface-card, white);
    border: 1px solid var(--surface-border, #e9ecef);
    border-radius: 8px;
    padding: 0.5rem;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    
    .controls-row {
      display: flex;
      align-items: center;
      gap: 1.0rem;
      flex-wrap: nowrap;
      
      // Search Box
      .search-box {
        flex: 1;
        min-width: 100px;
        
        .search-input-wrapper {
          position: relative;
          display: flex;
          align-items: center;
          
          .search-icon {
            position: absolute;
            left: 0.75rem;
            color: var(--text-color-secondary, #6c757d);
            font-size: 0.875rem;
            z-index: 1;
          }
          
          .search-input {
            width: 100%;
            padding: 0.75rem 0.75rem 0.75rem 2.5rem;
            border: 1px solid var(--surface-border, #e9ecef);
            border-radius: 8px;
            font-size: 0.875rem;
            background: var(--surface-ground, #f8f9fa);
            transition: all 0.3s ease;
            
            &:focus {
              outline: none;
              border-color: var(--primary-color, #2196f3);
              background: var(--surface-card, white);
              box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.1);
            }
            
            &::placeholder {
              color: var(--text-color-placeholder, #adb5bd);
            }
          }
        }
      }
      
      // Sort Controls
      .sort-controls {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        flex-shrink: 0;
        
        .sort-label {
          font-size: 0.875rem;
          font-weight: 500;
          color: var(--text-color, #495057);
          white-space: nowrap;
        }
        
        .sort-buttons {
          display: flex;
          gap: 0.5rem;
          flex-wrap: nowrap;
          
          button {
            font-size: 0.875rem;
            padding: 0.5rem 0.75rem;
            border-radius: 6px;
            min-height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
            white-space: nowrap;
            
            &:hover {
              transform: translateY(-1px);
            }
          }
        }
      }
      
      // Filter Controls
      .filter-controls {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        flex-shrink: 0;
        
        .filter-dropdown {
          ::ng-deep .p-dropdown {
            width: 140px;
            min-height: 36px;
            
            .p-dropdown-label {
              font-size: 0.875rem;
              padding: 0.5rem 0.75rem;
            }
            
            .p-dropdown-trigger {
              width: 2rem;
            }
          }
        }
        
        .clear-btn {
          font-size: 0.875rem;
          padding: 0.5rem 0.75rem;
          min-height: 36px;
          border-radius: 6px;
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 0.5rem;
          transition: all 0.3s ease;
          white-space: nowrap;
          
          &:hover {
            transform: translateY(-1px);
          }
        }
      }
      
      // View Toggle
      .view-toggle {
        display: flex;
        gap: 0.5rem;
        flex-shrink: 0;
        
        .layout-btn {
          width: 36px;
          height: 36px;
          padding: 0;
          border-radius: 6px;
          display: flex;
          align-items: center;
          justify-content: center;
          transition: all 0.3s ease;
          
          &:hover {
            transform: translateY(-1px);
          }
          
          .p-button-icon {
            font-size: 0.875rem;
          }
        }
      }
    }
    
    // Control Label Styling
    .control-label {
      display: block;
      font-size: 0.875rem;
      font-weight: 500;
      color: var(--text-color-secondary, #6c757d);
      margin-bottom: 0.5rem;
      line-height: 1.2;
    }
  }

  // Portfolio Scroll Panel
  .portfolio-scroll-panel {
    flex: 1;
    height: calc(90vh - 200px); // 90% of viewport height minus controls height
    // margin: 1rem;
    
    ::ng-deep .p-scrollpanel {
      height: 100%;
      border: 1px solid var(--surface-border, #e9ecef);
      border-radius: 8px;
      background: var(--surface-ground, #f8f9fa);
      
      .p-scrollpanel-wrapper {
        height: 100%;
        
        .p-scrollpanel-content {
          padding: 1.5rem;
          height: 100%;
        }
      }
      
      .p-scrollpanel-bar {
        background: var(--surface-border, #e9ecef);
        border-radius: 4px;
        
        &.p-scrollpanel-bar-y {
          width: 8px;
        }
        
        &.p-scrollpanel-bar-x {
          height: 8px;
        }
      }
    }
  }

  // Portfolio Cards
  .portfolio-cards {
    .grid {
      display: grid !important; // Force grid display
      gap: 1.5rem;
      width: 100%;
      
      &.grid-layout {
        grid-template-columns: repeat(4, 1fr) !important; // Force 4 columns
        grid-auto-rows: minmax(320px, auto); // Reduced height for compactness (was 400px)
        
        // Responsive breakpoints
        @media (max-width: 1400px) {
          grid-template-columns: repeat(3, 1fr) !important; // 3 cards per row on medium screens
        }
        
        @media (max-width: 1100px) {
          grid-template-columns: repeat(2, 1fr) !important; // 2 cards per row on small screens
        }
        
        @media (max-width: 768px) {
          grid-template-columns: 1fr !important; // 1 card per row on mobile
        }
        
        .portfolio-item {
          margin: 1rem;
          // margin-bottom: 0;
          min-height: 320px; // Reduced height for compactness (was 400px)
          width: 100%; // Ensure full width
        }
      }
      
      &.list-layout {
        grid-template-columns: 1fr !important; // Single column for list view
        
        .portfolio-item {
          margin-bottom: 0;
          width: 100%; // Ensure full width
        }
      }
    }
    
    // Portfolio Card
    .portfolio-card {
      height: 100%;
      
      ::ng-deep .p-card {
        height: 100%;
        border-radius: 12px;
        border: 1px solid var(--surface-border, #e9ecef);
        box-shadow: var(--card-shadow, 0 2px 12px rgba(0, 0, 0, 0.08));
        transition: all 0.3s ease;
        
        &:hover {
          transform: translateY(-4px);
          box-shadow: var(--card-shadow-hover, 0 8px 25px rgba(0, 0, 0, 0.15));
        }
        
        .p-card-body {
          padding: 1.5rem !important; // Force internal padding
          height: 100%;
          display: flex;
          flex-direction: column;
        }
        
        .p-card-content {
          flex: 1;
          display: flex;
          flex-direction: column;
        }
      }
    }
    
    // Portfolio Performance Card
    .portfolio-performance-card {
      display: flex;
      flex-direction: column;
      height: 100%;
      gap: 1rem; // Reduced gap for compactness
      padding: 1.5rem; // Additional internal padding
      
      // Card Header
      .card-header {
        padding: 0.5rem 0; // Added padding
        
        .title-row {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          margin-bottom: 0.5rem; // Reduced margin for compactness
          
          .chart-icon {
            font-size: 1.25rem;
            color: var(--primary-color, #2196f3);
          }
          
          .portfolio-name {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-color, #495057);
            margin: 0;
            line-height: 1.2;
          }
        }
        
        .portfolio-subtitle {
          font-size: 0.875rem;
          color: var(--text-color-secondary, #6c757d);
          margin: 0;
          line-height: 1.2;
        }
      }
      
      // Performance Row
      .performance-row {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        gap: 1rem;
        padding: 0.75rem 0; // Added padding
        
        .left-metrics, .right-metrics {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
          
          .main-return {
            font-size: 1.25rem;
            font-weight: 700;
            line-height: 1.2;
          }
          
          .benchmark-info, .stock-count, .outperformance {
            font-size: 0.875rem;
            color: var(--text-color-secondary, #6c757d);
            line-height: 1.2;
          }
        }
      }
      
      // Chart Section
      .chart-section {
        padding: 0.5rem 0; // Added padding
        background-color: rgba(33, 150, 243, 0.08); // Light blue background with 0.08 opacity (not grey)
        border-radius: 8px; // Rounded corners for the background
        margin: 0.5rem 0; // Add some margin around the chart section
        
        .chart-container {
          position: relative;
          padding: 0.5rem; // Add padding inside the chart container
          
          .chart-svg {
            width: 100%;
            height: 80px; // Reduced chart height for compactness (was 120px)
          }
          
          .chart-time-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 0.5rem;
            
            .time-label {
              font-size: 0.75rem;
              color: var(--text-color-secondary, #6c757d);
            }
          }
        }
      }
      
      // Chart Legend
      .chart-legend {
        padding: 0.5rem 0; // Added padding
        
        .legend-row {
          display: flex;
          gap: 1rem;
          margin-bottom: 0.5rem; // Reduced margin for compactness
          
          .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            
            .legend-line {
              width: 20px;
              height: 3px;
              border-radius: 2px;
              
              &.portfolio-legend {
                background: var(--primary-color, #2196f3);
              }
              
              &.benchmark-legend {
                background: #999;
              }
              
              &.rebalance-dot {
                background: #ff9500;
              }
            }
            
            .legend-label {
              font-size: 0.75rem;
              color: var(--text-color-secondary, #6c757d);
            }
          }
        }
        
        .rebalance-info {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          
          .rebalance-icon {
            font-size: 0.75rem;
            color: #ff9500;
          }
          
          .rebalance-text {
            font-size: 0.75rem;
            color: var(--text-color-secondary, #6c757d);
          }
        }
      }
      
      // Card Actions
      .card-actions {
        display: flex;
        gap: 0.75rem;
        margin-top: auto;
        padding: 0.75rem 0; // Added padding
        
        button {
          flex: 1;
          font-size: 0.875rem;
          padding: 0.75rem;
          border-radius: 8px;
          min-height: 40px;
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 0.5rem;
          transition: all 0.3s ease;
          
          &:hover {
            transform: translateY(-1px);
          }
          
          // Configure button with orange outline
          &.configure-btn {
            border-color: var(--orange-500, #ff9500) !important;
            color: var(--orange-500, #ff9500) !important;
            
            &:hover {
              background-color: var(--orange-500, #ff9500) !important;
              color: white !important;
            }
          }
        }
      }
    }
    
    // List View Card
    .portfolio-list-card {
      background: var(--surface-card, white);
      border: 1px solid var(--surface-border, #e9ecef);
      border-radius: 12px;
      padding: 1.5rem;
      display: flex;
      align-items: center;
      gap: 1.5rem;
      box-shadow: var(--card-shadow, 0 2px 12px rgba(0, 0, 0, 0.08));
      transition: all 0.3s ease;
      
      &:hover {
        transform: translateY(-2px);
        box-shadow: var(--card-shadow-hover, 0 8px 25px rgba(0, 0, 0, 0.15));
      }
      
      .list-checkbox {
        flex-shrink: 0;
      }
      
      .list-main-content {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 1rem;
        
        .list-title-section {
          .list-portfolio-name {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-color, #495057);
            margin: 0 0 0.25rem 0;
            line-height: 1.2;
          }
          
          .list-portfolio-description {
            font-size: 0.875rem;
            color: var(--text-color-secondary, #6c757d);
            margin: 0;
            line-height: 1.2;
          }
        }
        
        .list-action-buttons {
          display: flex;
          gap: 0.75rem;
          
          button {
            font-size: 0.875rem;
            padding: 0.5rem 0.75rem;
            border-radius: 6px;
            min-height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
            
            &:hover {
              transform: translateY(-1px);
            }
            
            // Configure button with orange outline
            &.configure-btn {
              border-color: var(--orange-500, #ff9500) !important;
              color: var(--orange-500, #ff9500) !important;
              
              &:hover {
                background-color: var(--orange-500, #ff9500) !important;
                color: white !important;
              }
            }
          }
        }
        
        .list-metadata {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
          
          .metadata-item {
            display: flex;
            gap: 0.5rem;
            
            .metadata-label {
              font-size: 0.75rem;
              color: var(--text-color-secondary, #6c757d);
              min-width: 80px;
            }
            
            .metadata-value {
              font-size: 0.75rem;
              color: var(--text-color, #495057);
              
              &.status-active {
                color: var(--success-color, #28a745);
              }
              
              &.status-inactive {
                color: var(--danger-color, #dc3545);
              }
            }
          }
        }
      }
      
      .list-right-metrics {
        display: flex;
        flex-direction: column;
        gap: 1rem;
        align-items: flex-end;
        min-width: 120px;
        
        .metric-item {
          display: flex;
          flex-direction: column;
          align-items: flex-end;
          gap: 0.25rem;
          
          .metric-label {
            font-size: 0.75rem;
            color: var(--text-color-secondary, #6c757d);
          }
          
          .metric-value {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-color, #495057);
          }
        }
      }
    }
    
    // Pagination Info
    .pagination-info {
      text-align: center;
      padding: 1rem 0;
      margin-top: 1rem;
      border-top: 1px solid var(--surface-border, #e9ecef);
      height: 10%; // 10% of container height for pagination
      
      span {
        font-size: 0.875rem;
        color: var(--text-color-secondary, #6c757d);
      }
    }
  }

  .loading-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 4rem 2rem;
    background: var(--surface-card, white);
    border-radius: 12px;
    box-shadow: var(--card-shadow, 0 2px 12px rgba(0, 0, 0, 0.08));

    .loading-spinner {
      font-size: 3rem;
      color: var(--primary-color, #667eea);
      margin-bottom: 1rem;
    }

    .loading-text {
      font-size: 1.1rem;
      color: var(--text-color-secondary, #6c757d);
      margin: 0;
    }
  }

  .error-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 4rem 2rem;
    background: var(--surface-card, white);
    border-radius: 12px;
    box-shadow: var(--card-shadow, 0 2px 12px rgba(0, 0, 0, 0.08));
    border: 2px solid var(--red-200, #ffebee);

    .error-icon {
      font-size: 3rem;
      color: var(--red-500, #f44336);
      margin-bottom: 1rem;
    }

    h3 {
      color: var(--red-700, #d32f2f);
      margin: 0 0 1rem 0;
      font-size: 1.5rem;
    }

    .error-message {
      color: var(--text-color, #666);
      margin: 0 0 1rem 0;
      font-size: 1.1rem;
    }

    .demo-note {
      color: var(--blue-700, #1976d2);
      margin: 0;
      font-size: 1rem;
      font-style: italic;
      background: var(--blue-50, #e3f2fd);
      padding: 0.5rem 1rem;
      border-radius: 6px;
    }
  }

  .empty-message {
    text-align: center;
    padding: 4rem 2rem;
    background: var(--surface-card, white);
    border-radius: 12px;
    border: 1px solid var(--surface-border, #e9ecef);

    .empty-icon {
      font-size: 4rem;
      color: var(--surface-border, #dee2e6);
      margin-bottom: 1rem;
    }

    h3 {
      color: var(--text-color, #495057);
      margin-bottom: 0.5rem;
    }

    p {
      color: var(--text-color-secondary, #6c757d);
      margin-bottom: 1.5rem;
    }
  }
}

// Responsive design
@media (max-width: 768px) {
  .content-section {
    .portfolio-display-container {
      padding: 1rem;

      .controls-section {
        flex-direction: column;
        align-items: stretch;
        gap: 1rem;

        .search-box {
          min-width: 100%;

          .search-input-wrapper {
            height: 48px;

            .search-input {
              height: 48px;
            }
          }
        }

        .sort-controls {
          justify-content: center;
          flex-wrap: wrap;
        }

        .filter-controls {
          justify-content: center;
          flex-wrap: wrap;

          .filter-dropdown {
            min-width: 100%;
            max-width: 100%;
            height: 48px;

            ::ng-deep .p-select {
              .p-select-label {
                height: 48px;
              }
            }
          }

          .clear-btn {
            height: 48px;
          }
        }

        .view-toggle {
          justify-content: center;
          height: 48px;

          button {
            height: 48px;
            min-width: 48px;
          }
        }
      }

      .portfolio-cards {
        .portfolio-list-card {
          flex-direction: column;
          align-items: stretch;
          gap: 1rem;
          padding: 1rem;

          .list-checkbox {
            align-self: flex-start;
            width: auto;
            height: auto;
          }

          .list-main-content {
            .list-title-section {
              .list-portfolio-description {
                max-width: none;
              }
            }

            .list-action-buttons {
              justify-content: center;
            }

            .list-metadata {
              .metadata-item {
                justify-content: space-between;
                
                .metadata-label {
                  min-width: auto;
                }
              }
            }
          }

          .list-right-metrics {
            text-align: center;
            min-width: auto;
            flex-direction: row;
            justify-content: space-around;

            .metric-item {
              text-align: center;
            }
          }
        }
      }
    }
  }
}

// Responsive Design for Controls
@media (max-width: 1200px) {
  .controls-section .controls-row {
    gap: 1.5rem;
    
    .search-box {
      min-width: 180px;
    }
    
    .sort-controls {
      min-width: 160px;
      
      .sort-buttons button {
        padding: 0.5rem 0.5rem;
        font-size: 0.8rem;
      }
    }
    
    .filter-controls {
      min-width: 180px;
    }
  }
}

@media (max-width: 992px) {
  .controls-section .controls-row {
    gap: 1rem;
    
    .search-box {
      min-width: 150px;
    }
    
    .sort-controls {
      min-width: 140px;
      
      .sort-buttons button {
        padding: 0.4rem 0.4rem;
        font-size: 0.75rem;
        min-height: 32px;
      }
    }
    
    .filter-controls {
      min-width: 160px;
      
      .clear-btn {
        padding: 0.4rem 0.5rem;
        min-height: 32px;
        font-size: 0.8rem;
      }
    }
    
    .view-toggle {
      min-width: 100px;
      
      .layout-btn {
        width: 32px;
        height: 32px;
      }
    }
  }
}

@media (max-width: 768px) {
  .controls-section .controls-row {
    flex-wrap: wrap;
    gap: 1rem;
    
    .search-box {
      flex: 1 1 100%;
      min-width: auto;
      order: 1;
    }
    
    .sort-controls {
      flex: 1 1 auto;
      min-width: auto;
      order: 2;
    }
    
    .filter-controls {
      flex: 1 1 auto;
      min-width: auto;
      order: 3;
    }
    
    .view-toggle {
      flex: 1 1 auto;
      min-width: auto;
      order: 4;
    }
  }
}

// Controls Card Styling
.controls-card {
  ::ng-deep .p-card {
    background: var(--surface-card, white);
    border: 1px solid var(--surface-border, #e9ecef);
    border-radius: 8px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    
    .p-card-body {
      padding: 1rem;
    }
    
    .p-card-content {
      padding: 0;
    }
  }
}
